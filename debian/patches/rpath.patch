--- a/cmake/CMakeLists.txt
+++ b/cmake/CMakeLists.txt
@@ -21,6 +21,19 @@
 file(GLOB LMP_SOURCES ${LAMMPS_SOURCE_DIR}/main.cpp)
 list(REMOVE_ITEM LIB_SOURCES ${LMP_SOURCES})
 
+# RPATH fix
+set(CMAKE_INSTALL_RPATH_USE_LINK_PATH TRUE)
+if(${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
+ set(CMAKE_INSTALL_NAME_DIR "${CMAKE_INSTALL_PREFIX}/lib")
+else()
+ set(CMAKE_INSTALL_RPATH "${CMAKE_INSTALL_PREFIX}/lib")
+endif()
+
+#policy update CMP0042
+if(APPLE)
+  set(CMAKE_MACOSX_RPATH ON)
+endif()
+
 # Utility functions
 function(list_to_bulletpoints result)
     list(REMOVE_AT ARGV 0)
